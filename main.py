import numpy as np
import random
from malware_classifier import MalwareClassifier
from sklearn.model_selection import train_test_split 
from dataset import load_drebin, get_prefixes

prefixes = get_prefixes()
random.shuffle(prefixes)
chunks = [prefixes[x:x+3] for x in range(0, len(prefixes), 3)]

for p in chunks:
    print("training with %s" % p)

    X, y = load_drebin(p)
    
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33)
    md = MalwareClassifier('random')

    print('training...')
    md.fit(X_train, y_train)

    print('evaluating...')
    y_pred = md.predict(X_test)

    res = md.scores(y_pred, y_test)
    md.print_results(res)